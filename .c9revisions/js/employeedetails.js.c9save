{"ts":1355237809929,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"var scroll = new iScroll('wrapper', { vScrollbar: false, hScrollbar:false, hScroll: false });\n\nvar id = getUrlVars()[\"id\"];\n\nvar db;\n\ndocument.addEventListener(\"deviceready\", onDeviceReady, false);\n\nfunction onDeviceReady() {\n\tconsole.log(\"opening database\");\n    db = window.openDatabase(\"EmployeeDirectoryDB\", \"1.0\", \"PhoneGap Demo\", 200000);\n\tconsole.log(\"database opened\");\n    db.transaction(getEmployee, transaction_error);\n}\n\nfunction transaction_error(tx, error) {\n\t$('#busy').hide();\n    alert(\"Database Error: \" + error);\n}\n\nfunction getEmployee(tx) {\n\t$('#busy').show();\n\tvar sql = \"select e.id, e.firstName, e.lastName, e.managerId, e.title, e.department, e.city, e.officePhone, e.cellPhone, \" +\n\t\t\t\t\"e.email, e.picture, m.firstName managerFirstName, m.lastName managerLastName, count(r.id) reportCount \" +\n\t\t\t\t\"from employee e left join employee r on r.managerId = e.id left join employee m on e.managerId = m.id \" +\n\t\t\t\t\"where e.id=:id group by e.lastName order by e.lastName, e.firstName\";\n\ttx.executeSql(sql, [id], getEmployee_success);\n}\n\nfunction getEmployee_success(tx, results) {\n\t$('#busy').hide();\n\tvar employee = results.rows.item(0);\n\t$('#employeePic').attr('src', 'pics/' + employee.picture);\n\t$('#fullName').text(employee.firstName + ' ' + employee.lastName);\n\t$('#employeeTitle').text(employee.title);\n\t$('#city').text(employee.city);\n\tconsole.log(employee.officePhone);\n\tif (employee.managerId>0) {\n\t\t$('#actionList').append('<li><a href=\"employeedetails.html?id=' + employee.managerId + '\"><p class=\"line1\">View Manager</p>' +\n\t\t\t\t'<p class=\"line2\">' + employee.managerFirstName + ' ' + employee.managerLastName + '</p></a></li>');\n\t}\n\tif (employee.reportCount>0) {\n\t\t$('#actionList').append('<li><a href=\"reportlist.html?id=' + employee.id + '\"><p class=\"line1\">View Direct Reports</p>' +\n\t\t\t\t'<p class=\"line2\">' + employee.reportCount + '</p></a></li>');\n\t}\n\tif (employee.email) {\n\t\t$('#actionList').append('<li><a href=\"mailto:' + employee.email + '\"><p class=\"line1\">Email</p>' +\n\t\t\t\t'<p class=\"line2\">' + employee.email + '</p><img src=\"img/mail.png\" class=\"action-icon\"/></a></li>');\n\t}\n\tif (employee.officePhone) {\n\t\t$('#actionList').append('<li><a href=\"tel:' + employee.officePhone + '\"><p class=\"line1\">Call Office</p>' +\n\t\t\t\t'<p class=\"line2\">' + employee.officePhone + '</p><img src=\"img/phone.png\" class=\"action-icon\"/></a></li>');\n\t}\n\tif (employee.cellPhone) {\n\t\t$('#actionList').append('<li><a href=\"tel:' + employee.cellPhone + '\"><p class=\"line1\">Call Cell</p>' +\n\t\t\t\t'<p class=\"line2\">' + employee.cellPhone + '</p><img src=\"img/phone.png\" class=\"action-icon\"/></a></li>');\n\t\t$('#actionList').append('<li><a href=\"sms:' + employee.cellPhone + '\"><p class=\"line1\">SMS</p>' +\n\t\t\t\t'<p class=\"line2\">' + employee.cellPhone + '</p><img src=\"img/sms.png\" class=\"action-icon\"/></a></li>');\n\t}\n\tsetTimeout(function(){\n\t\tscroll.refresh();\n\t});\n\tdb = null;\n}\n\nfunction getUrlVars() {\n    var vars = [], hash;\n    var hashes = window.location.href.slice(window.location.href.indexOf('?') + 1).split('&');\n    for(var i = 0; i < hashes.length; i++)\n    {\n        hash = hashes[i].split('=');\n        vars.push(hash[0]);\n        vars[hash[0]] = hash[1];\n    }\n    return vars;\n}\n"]],"start1":0,"start2":0,"length1":0,"length2":3213}]],"length":3213}
{"contributors":[],"silentsave":false,"ts":1355238107391,"patch":[[{"diffs":[[0,"le.log(\""],[-1,"o"],[1,"O"],[0,"pening d"]],"start1":232,"start2":232,"length1":17,"length2":17},{"diffs":[[0,"tabase(\""],[-1,"Employee"],[0,"Director"]],"start1":282,"start2":282,"length1":24,"length2":16},{"diffs":[[0,"\", \""],[-1,"PhoneGap Demo"],[1,"Directory"],[0,"\", 2"]],"start1":308,"start2":308,"length1":21,"length2":17},{"diffs":[[0,"le.log(\""],[-1,"d"],[1,"D"],[0,"atabase "]],"start1":339,"start2":339,"length1":17,"length2":17}]],"length":3201,"saved":false}
{"ts":1355262229501,"patch":[[{"diffs":[[0,"dy() {\n\t"],[-1,"console.log"],[1,"alert"],[0,"(\"Openin"]],"start1":219,"start2":219,"length1":27,"length2":21},{"diffs":[[0,"0000);\n\t"],[-1,"console.log"],[1,"alert"],[0,"(\"Databa"]],"start1":320,"start2":320,"length1":27,"length2":21},{"diffs":[[0,"y').hide();\n"],[1,"    alert('Got data for employee');\n"],[0,"\tvar employe"]],"start1":1084,"start2":1084,"length1":24,"length2":60}]],"length":3225,"saved":false}
