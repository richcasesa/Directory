{"ts":1354761611234,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"var db;\nvar dbCreated = false;\n\nvar scroll = new iScroll('wrapper', { vScrollbar: false, hScrollbar:false, hScroll: false });\n\ndocument.addEventListener(\"deviceready\", onDeviceReady, false);\n\nfunction onDeviceReady() {\n    db = window.openDatabase(\"EmployeeDirectoryDB\", \"1.0\", \"PhoneGap Demo\", 200000);\n    if (dbCreated)\n    \tdb.transaction(getEmployees, transaction_error);\n    else\n    \tdb.transaction(populateDB, transaction_error, populateDB_success);\n}\n\nfunction transaction_error(tx, error) {\n\t$('#busy').hide();\n    alert(\"Database Error: \" + error);\n}\n\nfunction populateDB_success() {\n\tdbCreated = true;\n    db.transaction(getEmployees, transaction_error);\n}\n\nfunction getEmployees(tx) {\n\tvar sql = \"select e.id, e.firstName, e.lastName, e.title, e.picture, count(r.id) reportCount \" + \n\t\t\t\t\"from employee e left join employee r on r.managerId = e.id \" +\n\t\t\t\t\"group by e.id order by e.lastName, e.firstName\";\n\ttx.executeSql(sql, [], getEmployees_success);\n}\n\nfunction getEmployees_success(tx, results) {\n\t$('#busy').hide();\n    var len = results.rows.length;\n    for (var i=0; i<len; i++) {\n    \tvar employee = results.rows.item(i);\n\t\t$('#employeeList').append('<li><a href=\"employeedetails.html?id=' + employee.id + '\">' +\n\t\t\t\t'<img src=\"pics/' + employee.picture + '\" class=\"list-icon\"/>' +\n\t\t\t\t'<p class=\"line1\">' + employee.firstName + ' ' + employee.lastName + '</p>' +\n\t\t\t\t'<p class=\"line2\">' + employee.title + '</p>' +\n\t\t\t\t'<span class=\"bubble\">' + employee.reportCount + '</span></a></li>');\n    }\n\tsetTimeout(function(){\n\t\tscroll.refresh();\n\t},100);\n\tdb = null;\n}\n\nfunction populateDB(tx) {\n\t$('#busy').show();\n\ttx.executeSql('DROP TABLE IF EXISTS employee');\n\tvar sql = \n\t\t\"CREATE TABLE IF NOT EXISTS employee ( \"+\n\t\t\"id INTEGER PRIMARY KEY AUTOINCREMENT, \" +\n\t\t\"firstName VARCHAR(50), \" +\n\t\t\"lastName VARCHAR(50), \" +\n\t\t\"title VARCHAR(50), \" +\n\t\t\"department VARCHAR(50), \" + \n\t\t\"managerId INTEGER, \" +\n\t\t\"city VARCHAR(50), \" +\n\t\t\"officePhone VARCHAR(30), \" + \n\t\t\"cellPhone VARCHAR(30), \" +\n\t\t\"email VARCHAR(30), \" +\n\t\t\"picture VARCHAR(200))\";\n    tx.executeSql(sql);\n\n    tx.executeSql(\"INSERT INTO employee (id,firstName,lastName,managerId,title,department,officePhone,cellPhone,email,city,picture) VALUES (12,'Steven','Wells',4,'Software Architect','Engineering','617-000-0012','781-000-0012','swells@fakemail.com','Boston, MA','steven_wells.jpg')\");\n    tx.executeSql(\"INSERT INTO employee (id,firstName,lastName,managerId,title,department,officePhone,cellPhone,email,city,picture) VALUES (11,'Amy','Jones',5,'Sales Representative','Sales','617-000-0011','781-000-0011','ajones@fakemail.com','Boston, MA','amy_jones.jpg')\");\n    tx.executeSql(\"INSERT INTO employee (id,firstName,lastName,managerId,title,department,officePhone,cellPhone,email,city,picture) VALUES (10,'Kathleen','Byrne',5,'Sales Representative','Sales','617-000-0010','781-000-0010','kbyrne@fakemail.com','Boston, MA','kathleen_byrne.jpg')\");\n    tx.executeSql(\"INSERT INTO employee (id,firstName,lastName,managerId,title,department,officePhone,cellPhone,email,city,picture) VALUES (9,'Gary','Donovan',2,'Marketing','Marketing','617-000-0009','781-000-0009','gdonovan@fakemail.com','Boston, MA','gary_donovan.jpg')\");\n    tx.executeSql(\"INSERT INTO employee (id,firstName,lastName,managerId,title,department,officePhone,cellPhone,email,city,picture) VALUES (8,'Lisa','Wong',2,'Marketing Manager','Marketing','617-000-0008','781-000-0008','lwong@fakemail.com','Boston, MA','lisa_wong.jpg')\");\n    tx.executeSql(\"INSERT INTO employee (id,firstName,lastName,managerId,title,department,officePhone,cellPhone,email,city,picture) VALUES (7,'Paula','Gates',4,'Software Architect','Engineering','617-000-0007','781-000-0007','pgates@fakemail.com','Boston, MA','paula_gates.jpg')\");\n    tx.executeSql(\"INSERT INTO employee (id,firstName,lastName,managerId,title,department,officePhone,cellPhone,email,city,picture) VALUES (5,'Ray','Moore',1,'VP of Sales','Sales','617-000-0005','781-000-0005','rmoore@fakemail.com','Boston, MA','ray_moore.jpg')\");\n    tx.executeSql(\"INSERT INTO employee (id,firstName,lastName,managerId,title,department,officePhone,cellPhone,email,city,picture) VALUES (6,'Paul','Jones',4,'QA Manager','Engineering','617-000-0006','781-000-0006','pjones@fakemail.com','Boston, MA','paul_jones.jpg')\");\n    tx.executeSql(\"INSERT INTO employee (id,firstName,lastName,managerId,title,department,officePhone,cellPhone,email,city,picture) VALUES (3,'Eugene','Lee',1,'CFO','Accounting','617-000-0003','781-000-0003','elee@fakemail.com','Boston, MA','eugene_lee.jpg')\");\n    tx.executeSql(\"INSERT INTO employee (id,firstName,lastName,managerId,title,department,officePhone,cellPhone,email,city,picture) VALUES (4,'John','Williams',1,'VP of Engineering','Engineering','617-000-0004','781-000-0004','jwilliams@fakemail.com','Boston, MA','john_williams.jpg')\");\n    tx.executeSql(\"INSERT INTO employee (id,firstName,lastName,managerId,title,department,officePhone,cellPhone,email,city,picture) VALUES (2,'Julie','Taylor',1,'VP of Marketing','Marketing','617-000-0002','781-000-0002','jtaylor@fakemail.com','Boston, MA','julie_taylor.jpg')\");\n    tx.executeSql(\"INSERT INTO employee (id,firstName,lastName,managerId,title,department,officePhone,cellPhone,email,city,picture) VALUES (1,'James','King',0,'President and CEO','Corporate','617-000-0001','781-000-0001','jking@fakemail.com','Boston, MA','james_king.jpg')\");\n}\n"]],"start1":0,"start2":0,"length1":0,"length2":5411}]],"length":5411}
{"contributors":[],"silentsave":false,"ts":1354762890389,"patch":[[{"diffs":[[0,"alse });"],[1,"\nalert('in employeelist');"],[0,"\n\ndocume"]],"start1":117,"start2":117,"length1":16,"length2":42},{"diffs":[[0,"ceReady() {\n"],[1,"    alert('in onDeviceReady');\n"],[0,"    db = win"]],"start1":233,"start2":233,"length1":24,"length2":55},{"diffs":[[0,"reated)\n    "],[-1,"\t"],[1,"    "],[0,"db.transacti"]],"start1":372,"start2":372,"length1":25,"length2":28},{"diffs":[[0,"lse\n    "],[-1,"\t"],[1,"    "],[0,"db.trans"]],"start1":442,"start2":442,"length1":17,"length2":20},{"diffs":[[0,") {\n    "],[-1,"\t"],[1,"    "],[0,"var empl"]],"start1":1160,"start2":1160,"length1":17,"length2":20}]],"length":5477,"saved":false}
{"contributors":[],"silentsave":false,"ts":1354828920221,"patch":[[{"diffs":[[0,"200))\";\n"],[1,"    alert(\"Running: \" + sql);\n"],[0,"    tx.e"]],"start1":2123,"start2":2123,"length1":16,"length2":46}]],"length":5507,"saved":false}
{"contributors":[],"silentsave":false,"ts":1354907080760,"patch":[[{"diffs":[[0,"reated)\n"],[1,"        alert('calling getEmployees');\n"],[0,"        "]],"start1":372,"start2":372,"length1":16,"length2":55},{"diffs":[[0,"   else\n"],[1,"        alert('calling populateDB');\n"],[0,"        "]],"start1":477,"start2":477,"length1":16,"length2":53}]],"length":5583,"saved":false}
{"ts":1354907371212,"patch":[[{"diffs":[[0,"Created)"],[1," {"],[0,"\n"],[-1,""],[0,"        "]],"start1":371,"start2":371,"length1":17,"length2":19},{"diffs":[[0,"r);\n"],[1,"    }\n"],[0,"    else"],[1," {"],[0,"\n   "]],"start1":474,"start2":474,"length1":16,"length2":24},{"diffs":[[0,"pulateDB');\n"],[-1,""],[0,"        db.t"]],"start1":520,"start2":520,"length1":24,"length2":24},{"diffs":[[0,"ateDB_success);\n"],[1,"    }\n"],[0,"}\n\nfunction tran"]],"start1":591,"start2":591,"length1":32,"length2":38}]],"length":5599,"saved":false}
