{"ts":1354761611234,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"var db;\nvar dbCreated = false;\n\nvar scroll = new iScroll('wrapper', { vScrollbar: false, hScrollbar:false, hScroll: false });\n\ndocument.addEventListener(\"deviceready\", onDeviceReady, false);\n\nfunction onDeviceReady() {\n    db = window.openDatabase(\"EmployeeDirectoryDB\", \"1.0\", \"PhoneGap Demo\", 200000);\n    if (dbCreated)\n    \tdb.transaction(getEmployees, transaction_error);\n    else\n    \tdb.transaction(populateDB, transaction_error, populateDB_success);\n}\n\nfunction transaction_error(tx, error) {\n\t$('#busy').hide();\n    alert(\"Database Error: \" + error);\n}\n\nfunction populateDB_success() {\n\tdbCreated = true;\n    db.transaction(getEmployees, transaction_error);\n}\n\nfunction getEmployees(tx) {\n\tvar sql = \"select e.id, e.firstName, e.lastName, e.title, e.picture, count(r.id) reportCount \" + \n\t\t\t\t\"from employee e left join employee r on r.managerId = e.id \" +\n\t\t\t\t\"group by e.id order by e.lastName, e.firstName\";\n\ttx.executeSql(sql, [], getEmployees_success);\n}\n\nfunction getEmployees_success(tx, results) {\n\t$('#busy').hide();\n    var len = results.rows.length;\n    for (var i=0; i<len; i++) {\n    \tvar employee = results.rows.item(i);\n\t\t$('#employeeList').append('<li><a href=\"employeedetails.html?id=' + employee.id + '\">' +\n\t\t\t\t'<img src=\"pics/' + employee.picture + '\" class=\"list-icon\"/>' +\n\t\t\t\t'<p class=\"line1\">' + employee.firstName + ' ' + employee.lastName + '</p>' +\n\t\t\t\t'<p class=\"line2\">' + employee.title + '</p>' +\n\t\t\t\t'<span class=\"bubble\">' + employee.reportCount + '</span></a></li>');\n    }\n\tsetTimeout(function(){\n\t\tscroll.refresh();\n\t},100);\n\tdb = null;\n}\n\nfunction populateDB(tx) {\n\t$('#busy').show();\n\ttx.executeSql('DROP TABLE IF EXISTS employee');\n\tvar sql = \n\t\t\"CREATE TABLE IF NOT EXISTS employee ( \"+\n\t\t\"id INTEGER PRIMARY KEY AUTOINCREMENT, \" +\n\t\t\"firstName VARCHAR(50), \" +\n\t\t\"lastName VARCHAR(50), \" +\n\t\t\"title VARCHAR(50), \" +\n\t\t\"department VARCHAR(50), \" + \n\t\t\"managerId INTEGER, \" +\n\t\t\"city VARCHAR(50), \" +\n\t\t\"officePhone VARCHAR(30), \" + \n\t\t\"cellPhone VARCHAR(30), \" +\n\t\t\"email VARCHAR(30), \" +\n\t\t\"picture VARCHAR(200))\";\n    tx.executeSql(sql);\n\n    tx.executeSql(\"INSERT INTO employee (id,firstName,lastName,managerId,title,department,officePhone,cellPhone,email,city,picture) VALUES (12,'Steven','Wells',4,'Software Architect','Engineering','617-000-0012','781-000-0012','swells@fakemail.com','Boston, MA','steven_wells.jpg')\");\n    tx.executeSql(\"INSERT INTO employee (id,firstName,lastName,managerId,title,department,officePhone,cellPhone,email,city,picture) VALUES (11,'Amy','Jones',5,'Sales Representative','Sales','617-000-0011','781-000-0011','ajones@fakemail.com','Boston, MA','amy_jones.jpg')\");\n    tx.executeSql(\"INSERT INTO employee (id,firstName,lastName,managerId,title,department,officePhone,cellPhone,email,city,picture) VALUES (10,'Kathleen','Byrne',5,'Sales Representative','Sales','617-000-0010','781-000-0010','kbyrne@fakemail.com','Boston, MA','kathleen_byrne.jpg')\");\n    tx.executeSql(\"INSERT INTO employee (id,firstName,lastName,managerId,title,department,officePhone,cellPhone,email,city,picture) VALUES (9,'Gary','Donovan',2,'Marketing','Marketing','617-000-0009','781-000-0009','gdonovan@fakemail.com','Boston, MA','gary_donovan.jpg')\");\n    tx.executeSql(\"INSERT INTO employee (id,firstName,lastName,managerId,title,department,officePhone,cellPhone,email,city,picture) VALUES (8,'Lisa','Wong',2,'Marketing Manager','Marketing','617-000-0008','781-000-0008','lwong@fakemail.com','Boston, MA','lisa_wong.jpg')\");\n    tx.executeSql(\"INSERT INTO employee (id,firstName,lastName,managerId,title,department,officePhone,cellPhone,email,city,picture) VALUES (7,'Paula','Gates',4,'Software Architect','Engineering','617-000-0007','781-000-0007','pgates@fakemail.com','Boston, MA','paula_gates.jpg')\");\n    tx.executeSql(\"INSERT INTO employee (id,firstName,lastName,managerId,title,department,officePhone,cellPhone,email,city,picture) VALUES (5,'Ray','Moore',1,'VP of Sales','Sales','617-000-0005','781-000-0005','rmoore@fakemail.com','Boston, MA','ray_moore.jpg')\");\n    tx.executeSql(\"INSERT INTO employee (id,firstName,lastName,managerId,title,department,officePhone,cellPhone,email,city,picture) VALUES (6,'Paul','Jones',4,'QA Manager','Engineering','617-000-0006','781-000-0006','pjones@fakemail.com','Boston, MA','paul_jones.jpg')\");\n    tx.executeSql(\"INSERT INTO employee (id,firstName,lastName,managerId,title,department,officePhone,cellPhone,email,city,picture) VALUES (3,'Eugene','Lee',1,'CFO','Accounting','617-000-0003','781-000-0003','elee@fakemail.com','Boston, MA','eugene_lee.jpg')\");\n    tx.executeSql(\"INSERT INTO employee (id,firstName,lastName,managerId,title,department,officePhone,cellPhone,email,city,picture) VALUES (4,'John','Williams',1,'VP of Engineering','Engineering','617-000-0004','781-000-0004','jwilliams@fakemail.com','Boston, MA','john_williams.jpg')\");\n    tx.executeSql(\"INSERT INTO employee (id,firstName,lastName,managerId,title,department,officePhone,cellPhone,email,city,picture) VALUES (2,'Julie','Taylor',1,'VP of Marketing','Marketing','617-000-0002','781-000-0002','jtaylor@fakemail.com','Boston, MA','julie_taylor.jpg')\");\n    tx.executeSql(\"INSERT INTO employee (id,firstName,lastName,managerId,title,department,officePhone,cellPhone,email,city,picture) VALUES (1,'James','King',0,'President and CEO','Corporate','617-000-0001','781-000-0001','jking@fakemail.com','Boston, MA','james_king.jpg')\");\n}\n"]],"start1":0,"start2":0,"length1":0,"length2":5411}]],"length":5411}
{"contributors":[],"silentsave":false,"ts":1354762890389,"patch":[[{"diffs":[[0,"alse });"],[1,"\nalert('in employeelist');"],[0,"\n\ndocume"]],"start1":117,"start2":117,"length1":16,"length2":42},{"diffs":[[0,"ceReady() {\n"],[1,"    alert('in onDeviceReady');\n"],[0,"    db = win"]],"start1":233,"start2":233,"length1":24,"length2":55},{"diffs":[[0,"reated)\n    "],[-1,"\t"],[1,"    "],[0,"db.transacti"]],"start1":372,"start2":372,"length1":25,"length2":28},{"diffs":[[0,"lse\n    "],[-1,"\t"],[1,"    "],[0,"db.trans"]],"start1":442,"start2":442,"length1":17,"length2":20},{"diffs":[[0,") {\n    "],[-1,"\t"],[1,"    "],[0,"var empl"]],"start1":1160,"start2":1160,"length1":17,"length2":20}]],"length":5477,"saved":false}
{"contributors":[],"silentsave":false,"ts":1354828920221,"patch":[[{"diffs":[[0,"200))\";\n"],[1,"    alert(\"Running: \" + sql);\n"],[0,"    tx.e"]],"start1":2123,"start2":2123,"length1":16,"length2":46}]],"length":5507,"saved":false}
{"contributors":[],"silentsave":false,"ts":1354907080760,"patch":[[{"diffs":[[0,"reated)\n"],[1,"        alert('calling getEmployees');\n"],[0,"        "]],"start1":372,"start2":372,"length1":16,"length2":55},{"diffs":[[0,"   else\n"],[1,"        alert('calling populateDB');\n"],[0,"        "]],"start1":477,"start2":477,"length1":16,"length2":53}]],"length":5583,"saved":false}
{"ts":1354907371212,"patch":[[{"diffs":[[0,"Created)"],[1," {"],[0,"\n"],[-1,""],[0,"        "]],"start1":371,"start2":371,"length1":17,"length2":19},{"diffs":[[0,"r);\n"],[1,"    }\n"],[0,"    else"],[1," {"],[0,"\n   "]],"start1":474,"start2":474,"length1":16,"length2":24},{"diffs":[[0,"pulateDB');\n"],[-1,""],[0,"        db.t"]],"start1":520,"start2":520,"length1":24,"length2":24},{"diffs":[[0,"ateDB_success);\n"],[1,"    }\n"],[0,"}\n\nfunction tran"]],"start1":591,"start2":591,"length1":32,"length2":38}]],"length":5599,"saved":false}
{"contributors":[],"silentsave":false,"ts":1355089090437,"patch":[[{"diffs":[[0," {\n\t"],[-1,"$('#busy').show("],[1,"alert('showing busy');\n    $('#busy').show();\n    alert('dropping table if exists'"],[0,");\n\t"]],"start1":1766,"start2":1766,"length1":24,"length2":90},{"diffs":[[0,"oyee');\n"],[1,"    alert('setting sql');\n"],[0,"\tvar sql"]],"start1":1896,"start2":1896,"length1":16,"length2":42},{"diffs":[[0,"l(sql);\n"],[1,"    alert('inserting employees');\n    "],[0,"\n    tx."]],"start1":2361,"start2":2361,"length1":16,"length2":54}]],"length":5729,"saved":false}
{"ts":1355113645879,"patch":[[{"diffs":[[0," false;\n"],[-1,""],[0,""],[1,"    "],[0,"\nvar scr"]],"start1":23,"start2":23,"length1":16,"length2":20},{"diffs":[[0," });"],[-1,"\nalert('in employeelist');\n\ndocument.addEventListener(\"deviceready\", onDeviceReady, false);\n\nfunction onDeviceReady() {\n    alert('in onDeviceReady');\n    db = window.openDatabase(\"EmployeeDirectoryDB\", \"1.0\", \"PhoneGap Demo\", 200000);\n    if (dbCreated) {\n        alert('calling getEmployees');\n        db.transaction(getEmployees, transaction_error);\n    }\n    else {\n        alert('calling populateDB');\n        db.transaction(populateDB, transaction_error, populateDB_success);\n    }\n}"],[0,"\n\nfu"]],"start1":125,"start2":125,"length1":497,"length2":8},{"diffs":[[0,"or: \" + error);\n"],[1,"    alert('Error Code: ' + error.code);\n"],[0,"}\n\nfunction popu"]],"start1":214,"start2":214,"length1":32,"length2":72},{"diffs":[[0,".jpg')\");\n}\n"],[1,"\nfunction onDeviceReady() {\n    alert('in onDeviceReady');\n    db = window.openDatabase(\"DirectoryDB\", \"1.0\", \"Directory\", 400000);\n    if (dbCreated) {\n        alert('calling getEmployees');\n        db.transaction(getEmployees, transaction_error);\n    }\n    else {\n        alert('calling populateDB');\n        db.transaction(populateDB, transaction_error, populateDB_success);\n    }\n}\n\ndocument.addEventListener(\"deviceready\", onDeviceReady, false);\n"]],"start1":5272,"start2":5272,"length1":12,"length2":463}]],"length":5735,"saved":false}
{"ts":1355114221167,"patch":[[{"diffs":[[0,") {\n"],[-1,"\talert('showing busy');\n"],[0,"    "]],"start1":1320,"start2":1320,"length1":32,"length2":8},{"diffs":[[0,"show();\n    "],[1,"//"],[0,"alert('dropp"]],"start1":1339,"start2":1339,"length1":24,"length2":26},{"diffs":[[0,"ists');\n"],[-1,"\t"],[1,"    //tx.executeSql('DROP TABLE IF EXISTS DEMO');\n\t//"],[0,"tx.execu"]],"start1":1380,"start2":1380,"length1":17,"length2":69},{"diffs":[[0,"rt('"],[-1,"in onDevice"],[1,"Cordova "],[0,"Read"]],"start1":5349,"start2":5349,"length1":19,"length2":16},{"diffs":[[0,"rt('"],[-1,"calling populateDB"],[1,"Populating Database"],[0,"');\n"]],"start1":5588,"start2":5588,"length1":26,"length2":27}]],"length":5763,"saved":false}
{"ts":1355114562362,"patch":[[{"diffs":[[0,"');\n"],[-1,"    alert('setting sql');\n"],[0,"\tvar"]],"start1":1485,"start2":1485,"length1":34,"length2":8},{"diffs":[[0,"rt(\""],[-1,"Running: \" + sql"],[1,"Creating table\""],[0,");\n "]],"start1":1881,"start2":1881,"length1":24,"length2":23},{"diffs":[[0,"rt('"],[-1,"insert"],[1,"Load"],[0,"ing "],[-1,"e"],[1,"E"],[0,"mplo"]],"start1":1934,"start2":1934,"length1":19,"length2":17}]],"length":5734,"saved":false}
{"ts":1355114904429,"patch":[[{"diffs":[[0,"= true;\n"],[1,"    alert('Employees loaded successfully');\n"],[0,"    db.t"]],"start1":316,"start2":316,"length1":16,"length2":60},{"diffs":[[0,"s(tx) {\n"],[1,"    alert('in get employees')''\n"],[0,"\tvar sql"]],"start1":444,"start2":444,"length1":16,"length2":48},{"diffs":[[0,"y').hide();\n"],[1,"    alert('in employees success');\n"],[0,"    var len "]],"start1":808,"start2":808,"length1":24,"length2":59}]],"length":5845,"saved":false}
{"ts":1355115136694,"patch":[[{"diffs":[[0,"es')"],[-1,"''"],[1,";"],[0,"\n\tva"]],"start1":477,"start2":477,"length1":10,"length2":9}]],"length":5844,"saved":false}
{"contributors":[],"silentsave":false,"ts":1355151520087,"patch":[[{"diffs":[[0,"ully');\n    "],[1,"//"],[0,"db.transacti"]],"start1":360,"start2":360,"length1":24,"length2":26},{"diffs":[[0,",100);\n\t"],[1,"//"],[0,"db = nul"]],"start1":1388,"start2":1388,"length1":16,"length2":18},{"diffs":[[0,";\n    }\n"],[1,"    alert('Closing db');\n    db = null;\n"],[0,"}\n\ndocum"]],"start1":5773,"start2":5773,"length1":16,"length2":56}]],"length":5888,"saved":false}
{"ts":1355151655562,"patch":[[{"diffs":[[0,"    if ("],[1,"!"],[0,"dbCreate"]],"start1":5528,"start2":5528,"length1":16,"length2":17},{"diffs":[[0,") {\n"],[-1,"        alert('calling getEmployees');\n        db.transaction(getEmployees, transaction_error);\n    }\n    else {\n"],[0,"    "]],"start1":5546,"start2":5546,"length1":121,"length2":8},{"diffs":[[0,"ccess);\n"],[-1,""],[0,"    }\n"],[1,"    alert('calling getEmployees');\n    db.transaction(getEmployees, transaction_error);\n"],[0,"    aler"]],"start1":5655,"start2":5655,"length1":22,"length2":110}]],"length":5864,"saved":false}
{"ts":1355154356247,"patch":[[{"diffs":[[0,"();\n    "],[-1,"//"],[0,"alert('d"]],"start1":1457,"start2":1457,"length1":18,"length2":16},{"diffs":[[0,"EMO');\n\t"],[-1,"//"],[0,"tx.execu"]],"start1":1543,"start2":1543,"length1":18,"length2":16}]],"length":5860,"saved":false}
{"ts":1355155034115,"patch":[[{"diffs":[[0,"rt('"],[-1,"Employees loaded"],[1,"transaction"],[0," suc"]],"start1":331,"start2":331,"length1":24,"length2":19},{"diffs":[[0,"sful"],[-1,"ly"],[0,"');\n"]],"start1":353,"start2":353,"length1":10,"length2":8}]],"length":5853,"saved":false}
{"ts":1355155169384,"patch":[[{"diffs":[[0,"ue;\n"],[-1,"    alert('transaction successful');\n"],[0,"    "]],"start1":320,"start2":320,"length1":45,"length2":8},{"diffs":[[0,"();\n"],[-1,"    alert('dropping table if exists');\n    //tx.executeSql('DROP TABLE IF EXISTS DEMO');\n"],[0,"\ttx."]],"start1":1413,"start2":1413,"length1":97,"length2":8}]],"length":5727,"saved":false}
{"ts":1355155635043,"patch":[[{"diffs":[[0,"ady() {\n    "],[1,"//"],[0,"alert('Cordo"]],"start1":5282,"start2":5282,"length1":24,"length2":26},{"diffs":[[0,"rt('"],[-1,"call"],[1,"Load"],[0,"ing "],[-1,"get"],[0,"Empl"]],"start1":5541,"start2":5541,"length1":19,"length2":16},{"diffs":[[0,"error);\n    "],[1,"//"],[0,"alert('Closi"]],"start1":5611,"start2":5611,"length1":24,"length2":26}]],"length":5728,"saved":false}
{"ts":1355155785249,"patch":[[{"diffs":[[0,"s(tx) {\n    "],[1,"//"],[0,"alert('in ge"]],"start1":402,"start2":402,"length1":24,"length2":26},{"diffs":[[0,"hide();\n    "],[1,"//"],[0,"alert('in em"]],"start1":771,"start2":771,"length1":24,"length2":26},{"diffs":[[0,"ql);\n    alert('"],[-1,"Loa"],[1,"Ad"],[0,"ding Employees')"]],"start1":1903,"start2":1903,"length1":35,"length2":34}]],"length":5731,"saved":false}
{"ts":1355159704616,"patch":[[{"diffs":[[0,"va Ready');\n"],[1,"    alert('dbCreated = ' + dbCreated);\n"],[0,"    db = win"]],"start1":5311,"start2":5311,"length1":24,"length2":63}]],"length":5770,"saved":false}
